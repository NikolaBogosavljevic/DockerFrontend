(this.webpackJsonpfrontend=this.webpackJsonpfrontend||[]).push([[0],{346:function(e,t,n){},347:function(e,t,n){},503:function(e,t){},505:function(e,t){},516:function(e,t){},518:function(e,t){},546:function(e,t){},547:function(e,t){},552:function(e,t){},554:function(e,t){},561:function(e,t){},580:function(e,t){},610:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),i=n(313),c=n.n(i),o=(n(346),n(347),n(14)),s=n(22),l=n(8),u=n(10),d=n(314),j=n.n(d).a.create({baseURL:"http://nikola.uek.dev.noseryoung.ch:28006"});j.interceptors.request.use((function(e){var t=localStorage.getItem("token");return t&&(e.headers.Authorization=t),e}),(function(e){return Promise.reject(e)})),j.interceptors.request.use((function(e){return e}),Promise.reject),j.interceptors.response.use((function(e){return e}),(function(e){return Promise.reject(e)}));var h=j,b=n(40),m=new Set,x={initAuthoritySet:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:JSON.parse(localStorage.getItem("user")||"{}");(e&&e.roles?e.roles:[]).forEach((function(e){e.authorities.forEach((function(e){m.add(e.name)}))}))},hasAuthority:function(e){return x.initAuthoritySet(),m.has(e)},hasAuthorities:function(e){x.initAuthoritySet();var t,n=Object(b.a)(e);try{for(n.s();!(t=n.n()).done;){var r=t.value;if(!m.has(r))return!1}}catch(a){n.e(a)}finally{n.f()}return!0},hasAnyAuthority:function(e){var t,n=Object(b.a)(e);try{for(n.s();!(t=n.n()).done;){var r=t.value;if(m.has(r))return!0}}catch(a){n.e(a)}finally{n.f()}return!1},clearAuthorities:function(){m.clear()}},f=x,O={getUser:function(){var e=Object(s.a)(Object(o.a)().mark((function e(t){var n,r;return Object(o.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h.get("/user/".concat(t));case 2:return n=e.sent,r=n.data,e.abrupt("return",r);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),updateUser:function(e){return h.put("/user/".concat(e.id),e)},addUser:function(e){return h.post("/user/registerUser",e).then((function(e){return e.data}))},getAllUsers:function(){return h.get("/user")},deleteUser:function(e){return h.delete("/user/".concat(e))}},p=O,g=n(1),v="user",y="token",S=function(){throw new Error("No provider for the ActiveUserContext found")},w={user:null,login:S,logout:S,setActiveUser:S,loadActiveUser:S,checkRole:S},C=Object(r.createContext)(w),k=C,I=function(e){var t=e.children,n=Object(r.useState)((function(){return function(){var e=localStorage.getItem(v);return null===e?null:JSON.parse(e)}()})),a=Object(l.a)(n,2),i=a[0],c=a[1],d=Object(u.o)(),j=function(e){c(e),localStorage.setItem(v,JSON.stringify(e))},b=function(){f.clearAuthorities(),localStorage.clear(),c(null)},m=function(){var e=Object(s.a)(Object(o.a)().mark((function e(t,n){return Object(o.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h.post("user/login",{email:t,password:n}).then((function(e){return console.log(e.headers.authorization),localStorage.setItem(y,e.headers.authorization),j(e.data),!0}));case 2:return e.abrupt("return",!1);case 3:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),x=function(){return i?p.getUser(i.id).then((function(e){j(e)})):null};return Object(r.useEffect)((function(){null!==localStorage.getItem(y)&&x()}),[]),Object(r.useEffect)((function(){null!==i&&(f.initAuthoritySet(i),localStorage.setItem(v,JSON.stringify(i)))}),[i]),Object(g.jsx)("div",{children:Object(g.jsx)(C.Provider,{value:{user:i,setActiveUser:j,login:m,logout:function(){null!==localStorage.getItem(y)?(h.get("/logout").finally(b),d("/login")):b()},loadActiveUser:x,checkRole:function(e){return!!i&&i.roles.some((function(t){return t.name===e}))}},children:t})})},N=n(684),A=n(685),B=n(679),R=n(686),U=n(694),E=n(687),z=n(53),F=n(58),q=F.object().shape({email:F.string(),password:F.string()}),L=function(){var e={margin:"8px 0"},t=Object(u.o)(),n=Object(r.useContext)(k).login;return Object(g.jsx)(N.a,{children:Object(g.jsxs)(A.a,{elevation:10,style:{padding:20,height:"70vh",width:280,margin:"20px auto"},children:[Object(g.jsxs)(N.a,{children:[Object(g.jsx)("h2",{children:"Sign In"}),Object(g.jsx)("p",{children:"Default login:"}),Object(g.jsx)("p",{children:"email: admin@example.com"}),Object(g.jsx)("p",{children:"pw: 1234"})]}),Object(g.jsx)(z.b,{initialValues:{email:"",password:""},enableReinitialize:!0,validationSchema:q,onSubmit:function(e){n(e.email.toLowerCase(),e.password).then((function(){console.log(e),t("/")})).catch((function(e){alert("login Error")}))},validateOnChange:!0,isInitialValid:!0,children:function(t){return Object(g.jsxs)(z.a,{onSubmit:t.handleSubmit,children:[Object(g.jsx)(B.a,{label:"email",id:"email",placeholder:"Enter username",fullWidth:!0,required:!0,autoFocus:!0,onChange:t.handleChange,onBlur:t.handleBlur,value:t.values.email}),t.errors.email&&Object(g.jsx)("div",{id:"feedback",children:t.errors.email}),Object(g.jsx)(B.a,{id:"password",label:"password",placeholder:"Enter password",type:"password",fullWidth:!0,required:!0,onChange:t.handleChange,onBlur:t.handleBlur,value:t.values.password}),t.errors.password&&Object(g.jsx)("div",{id:"feedback",children:t.errors.password}),Object(g.jsx)(R.a,{type:"submit",color:"primary",variant:"contained",style:e,fullWidth:!0,children:"Sign in"})]})}}),Object(g.jsx)(U.a,{children:Object(g.jsx)(E.a,{href:"#",children:"Forgot password ?"})}),Object(g.jsxs)(U.a,{children:[" ","Do you have an account ?",Object(g.jsx)(E.a,{href:"#",children:"Sign Up"})]})]})})},D=n(322),W=function(e){var t=e.element,n=e.authorities,a=Object(r.useContext)(k);return function(){var e=localStorage.getItem("token");if(!e)return console.error("no token found"),!1;e=e.replace("Bearer ","");var t=D.decode(e);return!(!t||!t.exp||t.exp<Date.now()/1e3)}()?0===n.length||n.some(f.hasAuthority)?Object(g.jsxs)("div",{children:[Object(g.jsx)(R.a,{onClick:a.logout,children:"Logout"}),t]}):Object(g.jsx)(u.a,{to:"/unauthorized",replace:!0}):(a.logout(),Object(g.jsx)(u.a,{to:"/login",replace:!0}))},P=n(690),G=n(692),M=n(691),V=function(){var e=Object(u.o)(),t=Object(r.useState)([]),n=Object(l.a)(t,2),a=n[0],i=n[1];Object(r.useEffect)((function(){p.getAllUsers().then((function(e){i(e.data)}))}),[]);return Object(g.jsxs)(g.Fragment,{children:[a.map((function(t){return Object(g.jsx)("div",{children:Object(g.jsx)(P.a,{sx:{minWidth:275},children:Object(g.jsxs)(M.a,{children:[t.firstName," ",t.lastName," ",t.email,Object(g.jsxs)(G.a,{children:[Object(g.jsx)(R.a,{size:"small",color:"primary",variant:"contained",onClick:function(){return n=t.id,void e("../useredit/"+n);var n},children:"Edit"}),Object(g.jsx)(R.a,{size:"small",color:"error",variant:"contained",onClick:function(){return e=t.id,void p.deleteUser(e);var e},children:"Delete"}),Object(g.jsx)(R.a,{size:"small",color:"error",variant:"contained",onClick:function(){return e("/users/".concat(t.id,"/posts"))},children:"Posts"})]})]})})},t.id)})),Object(g.jsx)(R.a,{size:"small",color:"success",variant:"contained",onClick:function(){e("../useredit/")},children:"Add"})]})},J=n(693),T=function(e){var t=e.user,n=e.submitActionHandler,r=Object(u.o)(),a=Object(z.c)({initialValues:{id:t.id,lastName:t?t.lastName:"",firstName:t?t.firstName:"",email:t?t.email:"",roles:t?t.roles:[]},validationSchema:Object(F.object)({firstName:Object(F.string)().required().min(2).max(50),lastName:Object(F.string)().required().min(2).max(50),email:Object(F.string)().required().email()}),onSubmit:function(e){n(e)},enableReinitialize:!0});return Object(g.jsx)(g.Fragment,{children:Object(g.jsxs)("form",{onSubmit:a.handleSubmit,children:[Object(g.jsxs)(J.a,{sx:{paddingTop:"15px"},children:[Object(g.jsx)(B.a,{id:"firstName",label:"Firstname",variant:"outlined",sx:{paddingRight:"10px"},onBlur:a.handleBlur,onChange:a.handleChange,error:Boolean(a.touched.firstName&&a.errors.firstName),value:a.values.firstName}),a.errors.firstName&&a.touched.firstName?Object(g.jsx)("div",{style:{color:"red"},children:a.errors.firstName}):null,Object(g.jsx)(B.a,{id:"lastName",label:"Lastname",variant:"outlined",sx:{paddingRight:"10px"},onBlur:a.handleBlur,onChange:a.handleChange,error:Boolean(a.touched.lastName&&a.errors.lastName),value:a.values.lastName}),a.errors.lastName&&a.touched.lastName?Object(g.jsx)("div",{style:{color:"red"},children:a.errors.lastName}):null,Object(g.jsx)(B.a,{id:"email",label:"E-Mail",variant:"outlined",onBlur:a.handleBlur,onChange:a.handleChange,error:Boolean(a.touched.email&&a.errors.email),value:a.values.email}),a.errors.email&&a.touched.email?Object(g.jsx)("div",{style:{color:"red"},children:a.errors.email}):null]}),Object(g.jsxs)("div",{children:[Object(g.jsxs)(R.a,{sx:{marginTop:"15px",marginRight:"10px"},variant:"contained",color:"success",type:"submit",disabled:!(a.dirty&&a.isValid),children:[t.id&&"Save",!t.id&&"Add"]}),Object(g.jsx)(R.a,{sx:{marginTop:"15px"},variant:"contained",color:"error",onClick:function(){r("/users")},children:"Cancel"})]})]})})},H=function(){var e=Object(u.o)(),t=Object(u.q)().userId,n=Object(r.useState)({id:"",firstName:"",lastName:"",email:"",roles:[]}),a=Object(l.a)(n,2),i=a[0],c=a[1];Object(r.useEffect)((function(){return function(){t&&p.getUser(t).then((function(e){return c(e)}))}}),[t]);return Object(g.jsx)(T,{user:i,submitActionHandler:function(n){void 0!==t?p.updateUser(n).then((function(){e("../users")})):p.addUser(n).then((function(){e("/users")}))}})},K=n(97),Q={updateImage:function(){var e=Object(s.a)(Object(o.a)().mark((function e(t){var n;return Object(o.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h.put("/imagepost/".concat(t.id),Object(K.a)(Object(K.a)({},t),{},{Image:t.image,Description:t.description}));case 2:(n=e.sent)&&200===n.status&&console.log("image successfully updated");case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),createImage:function(){var e=Object(s.a)(Object(o.a)().mark((function e(t){var n;return Object(o.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h.post("/imagepost/",t);case 2:(n=e.sent)&&200===n.status&&console.log("image successfully created");case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),getAllImages:function(){var e=Object(s.a)(Object(o.a)().mark((function e(){var t;return Object(o.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,h.get("/imagepost/");case 3:return t=e.sent,e.abrupt("return",t.data);case 7:return e.prev=7,e.t0=e.catch(0),console.error("ERRORRRRRRRR",e.t0),e.abrupt("return",[]);case 11:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}(),getImageById:function(){var e=Object(s.a)(Object(o.a)().mark((function e(t){var n;return Object(o.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h.get("/imagepost/".concat(t));case 2:return n=e.sent,console.log(n),e.abrupt("return",n.data);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),deleteImage:function(e){return h.delete("/image/".concat(e.id))}},X=Q,Y=n(695),Z=n(696),$=n(697),_=n(326),ee=n(323),te=n.n(ee),ne=n(688),re=n(689),ae=n(678),ie=n(682),ce=n(200),oe=n.n(ce),se=n(30),le=["Users","Posts","Login"],ue=["Profile","Account","Dashboard","Logout"];var de=function(){var e=r.useState(null),t=Object(l.a)(e,2),n=t[0],a=t[1],i=r.useState(null),c=Object(l.a)(i,2),o=c[0],s=c[1],u=function(){a(null)},d=function(){s(null)};return Object(g.jsx)(Y.a,{position:"static",children:Object(g.jsx)(ne.a,{maxWidth:"xl",children:Object(g.jsxs)(Z.a,{disableGutters:!0,children:[Object(g.jsx)(oe.a,{sx:{display:{xs:"none",md:"flex"},mr:1}}),Object(g.jsx)(U.a,{variant:"h6",noWrap:!0,component:"a",href:"/",sx:{mr:2,display:{xs:"none",md:"flex"},fontFamily:"monospace",fontWeight:700,letterSpacing:".3rem",color:"inherit",textDecoration:"none"},children:"LOGO"}),Object(g.jsxs)(J.a,{sx:{flexGrow:1,display:{xs:"flex",md:"none"}},children:[Object(g.jsx)($.a,{size:"large","aria-label":"account of current user","aria-controls":"menu-appbar","aria-haspopup":"true",onClick:function(e){a(e.currentTarget)},color:"inherit",children:Object(g.jsx)(te.a,{})}),Object(g.jsx)(_.a,{id:"menu-appbar",anchorEl:n,anchorOrigin:{vertical:"bottom",horizontal:"left"},keepMounted:!0,transformOrigin:{vertical:"top",horizontal:"left"},open:Boolean(n),onClose:u,sx:{display:{xs:"block",md:"none"}},children:le.map((function(e){return Object(g.jsx)(ie.a,{onClick:u,children:Object(g.jsx)(U.a,{textAlign:"center",children:e})},e)}))})]}),Object(g.jsx)(oe.a,{sx:{display:{xs:"flex",md:"none"},mr:1}}),Object(g.jsx)(U.a,{variant:"h5",noWrap:!0,component:"a",href:"/",sx:{mr:2,display:{xs:"flex",md:"none"},flexGrow:1,fontFamily:"monospace",fontWeight:700,letterSpacing:".3rem",color:"inherit",textDecoration:"none"},children:"LOGO"}),Object(g.jsxs)(J.a,{sx:{flexGrow:1,display:{xs:"none",md:"flex"}},children:[Object(g.jsx)(se.b,{to:"/users",children:Object(g.jsx)(R.a,{sx:{my:2,color:"white",display:"block"},children:le[0]},le[0])}),Object(g.jsx)(se.b,{to:"/",children:Object(g.jsx)(R.a,{onClick:u,sx:{my:2,color:"white",display:"block"},children:le[1]},le[1])}),Object(g.jsx)(se.b,{to:"/Login",children:Object(g.jsx)(R.a,{onClick:u,sx:{my:2,color:"white",display:"block"},children:le[2]},le[2])})]}),Object(g.jsxs)(J.a,{sx:{flexGrow:0},children:[Object(g.jsx)(ae.a,{title:"Open settings",children:Object(g.jsx)($.a,{onClick:function(e){s(e.currentTarget)},sx:{p:0},children:Object(g.jsx)(re.a,{alt:"Remy Sharp",src:"/static/images/avatar/2.jpg"})})}),Object(g.jsx)(_.a,{sx:{mt:"45px"},id:"menu-appbar",anchorEl:o,anchorOrigin:{vertical:"top",horizontal:"right"},keepMounted:!0,transformOrigin:{vertical:"top",horizontal:"right"},open:Boolean(o),onClose:d,children:ue.map((function(e){return Object(g.jsx)(ie.a,{onClick:d,children:Object(g.jsx)(U.a,{textAlign:"center",children:e})},e)}))})]})]})})})},je=n(681),he=n(324),be=n.n(he),me=n(325),xe=n.n(me),fe={inputProps:{"aria-label":"Checkbox demo"}};function Oe(){return Object(g.jsx)("div",{children:Object(g.jsx)(je.a,Object(K.a)(Object(K.a)({},fe),{},{icon:Object(g.jsx)(be.a,{}),checkedIcon:Object(g.jsx)(xe.a,{})}))})}function pe(){var e=Object(r.useContext)(k),t=r.useState([]),n=Object(l.a)(t,2),a=n[0],i=n[1];function c(t,n){if(t.author)return n.id===t.author.id||e.checkRole("ADMIN")}return r.useEffect((function(){X.getAllImages().then((function(e){console.log(e),i(e)})).catch((function(e){console.error("Fehler beim Abrufen der Bilder: ",e)}))}),[]),Object(g.jsxs)("div",{children:[Object(g.jsx)(de,{}),Object(g.jsx)(J.a,{children:Object(g.jsx)(N.a,{container:!0,spacing:1,children:a.map((function(t,n){return Object(g.jsx)(N.a,{item:!0,xs:2,marginTop:"10px",marginLeft:"45px",children:Object(g.jsxs)(A.a,{elevation:0,sx:{padding:2},children:[Object(g.jsx)("img",{src:t.image,alt:"Bild ".concat(n),style:{width:"100%",height:"100%",borderRadius:"0px",padding:"1px",margin:"10px"}}),Object(g.jsxs)("p",{children:[" ",t.author?t.author.firstName:"undefined"," "]}),Object(g.jsxs)("p",{children:[" ",t.description," "]}),Object(g.jsx)(Oe,{}),"                               ",e.user&&c(t,e.user)&&Object(g.jsx)("button",{children:"delete"}),Object(g.jsx)(se.b,{to:"/editimage/".concat(t.id),children:Object(g.jsx)("button",{children:"Edit"})})]})},n)}))})})]})}function ge(){Object(u.q)().id;var e=Object(u.o)(),t=Object(r.useContext)(k),n=Object(z.c)({initialValues:{image:"",description:""},onSubmit:function(e){a(e.image,e.description)}}),a=function(n,r){t.user&&X.createImage({image:n,description:r,author:t.user}).then((function(t){console.log("response",t),e("/")})).catch((function(e){postMessage(e.response.data)}))};return Object(g.jsxs)("form",{onSubmit:n.handleSubmit,children:[Object(g.jsxs)("div",{children:[Object(g.jsx)("h1",{children:"New Image"}),Object(g.jsx)("label",{htmlFor:"image",children:"Image"}),Object(g.jsx)("input",{id:"image",name:"image",type:"text",onChange:n.handleChange,onBlur:n.handleBlur,value:n.values.image})]}),Object(g.jsxs)("div",{children:[Object(g.jsx)("label",{htmlFor:"description",children:"description"}),Object(g.jsx)("input",{id:"description",name:"description",type:"text",onChange:n.handleChange,onBlur:n.handleBlur,value:n.values.description})]}),Object(g.jsx)("button",{type:"submit",children:"add"}),Object(g.jsxs)("button",{type:"submit",children:[" ",Object(g.jsx)("a",{href:"/"}),"cancel"]})]})}function ve(){var e=Object(u.q)().imageId,t=Object(u.o)(),n=Object(r.useState)([]),a=Object(l.a)(n,2),i=a[0],c=a[1],o=Object(z.c)({initialValues:{id:null!==e&&void 0!==e?e:"",image:"",description:""},onSubmit:function(e){s(e.image,e.description)}});Object(r.useEffect)((function(){X.getImageById(null!==e&&void 0!==e?e:"").then((function(t){c(t),console.log(i),o.setValues({id:null!==e&&void 0!==e?e:"",image:t.image,description:t.description})}))}),[]);var s=function(n,r){console.log("test",e),X.updateImage({id:null!==e&&void 0!==e?e:"",image:n,description:r,likes:0,author:{id:"",email:"",firstName:"",lastName:"",roles:[]}}).then((function(n){console.log("response",n),t("/editimage/".concat(e))})).catch((function(e){postMessage(e.response.data)}))};return Object(g.jsxs)("form",{onSubmit:o.handleSubmit,children:[Object(g.jsxs)("div",{children:[Object(g.jsx)("h1",{children:"Update Image"}),Object(g.jsx)("label",{htmlFor:"image",children:"image"}),Object(g.jsx)("input",{id:"image",name:"image",type:"text",onChange:o.handleChange,onBlur:o.handleBlur,value:o.values.image})]}),Object(g.jsxs)("div",{children:[Object(g.jsx)("label",{htmlFor:"description",children:"description"}),Object(g.jsx)("input",{id:"description",name:"description",type:"text",onChange:o.handleChange,onBlur:o.handleBlur,value:o.values.description})]}),Object(g.jsx)("button",{type:"submit",children:"send"})]})}var ye=function(){var e=Object(u.q)().id,t=Object(r.useState)(),n=Object(l.a)(t,2),i=(n[0],n[1]);Object(r.useEffect)((function(){p.getUser(null!==e&&void 0!==e?e:"").then((function(e){i(e)}))}),[]);var c=a.a.useState([]),o=Object(l.a)(c,2),s=(o[0],o[1]);return a.a.useEffect((function(){X.getAllImages().then((function(e){console.log(e),s(e)})).catch((function(e){console.error("Fehler beim Abrufen der Bilder: ",e)}))}),[]),Object(g.jsxs)("div",{children:[Object(g.jsx)(de,{}),Object(g.jsx)(J.a,{})]})},Se=function(){return Object(g.jsxs)(u.d,{children:[Object(g.jsx)(u.b,{path:"/",element:Object(g.jsx)(pe,{})}),Object(g.jsx)(u.b,{path:"/Login",element:Object(g.jsx)(L,{})}),Object(g.jsx)(u.b,{path:"/add",element:Object(g.jsx)(ge,{})}),Object(g.jsx)(u.b,{path:"/editimage/:imageId",element:Object(g.jsx)(ve,{})}),Object(g.jsx)(u.b,{path:"/users/:userId/posts",element:Object(g.jsx)(ye,{})}),Object(g.jsx)(u.b,{path:"/users",element:Object(g.jsx)(W,{authorities:[],element:Object(g.jsx)(V,{})})}),Object(g.jsx)(u.b,{path:"/useredit",element:Object(g.jsx)(W,{authorities:[],element:Object(g.jsx)(H,{})})}),Object(g.jsx)(u.b,{path:"/useredit/:userId",element:Object(g.jsx)(W,{authorities:[],element:Object(g.jsx)(H,{})})}),Object(g.jsx)(u.b,{path:"*",element:Object(g.jsx)("div",{children:"Not Found"})})]})};var we=function(){return Object(g.jsx)(I,{children:Object(g.jsx)(Se,{})})};c.a.createRoot(document.getElementById("root")).render(Object(g.jsx)(a.a.StrictMode,{children:Object(g.jsx)(se.a,{children:Object(g.jsx)(we,{})})}))}},[[610,1,2]]]);
//# sourceMappingURL=main.2fee0d5c.chunk.js.map